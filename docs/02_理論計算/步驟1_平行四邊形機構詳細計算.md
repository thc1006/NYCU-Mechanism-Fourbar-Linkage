# 步驟 1：平行四邊形機構快速可行解 - 詳細計算過程

## 📋 目錄
1. [理論基礎](#1-理論基礎)
2. [問題定義與座標系建立](#2-問題定義與座標系建立)
3. [平行四邊形機構的幾何分析](#3-平行四邊形機構的幾何分析)
4. [設計變數的確定](#4-設計變數的確定)
5. [詳細計算過程](#5-詳細計算過程)
6. [方案驗證與調整](#6-方案驗證與調整)
7. [最終設計參數](#7-最終設計參數)

---

## 1. 理論基礎

### 1.1 為什麼選擇平行四邊形機構？

平行四邊形四連桿機構是最簡單的四連桿機構之一，具有以下**關鍵特性**：

#### 定義
平行四邊形機構滿足以下幾何條件：

$$
\begin{cases}
L_2 = L_4 & \text{(對邊相等)} \\
L_1 = L_3 & \text{(對邊相等)} \\
L_2 \parallel L_4 & \text{(對邊平行)} \\
L_1 \parallel L_3 & \text{(對邊平行)}
\end{cases}
$$

其中：
- $L_1$：ground link（固定桿）= $|O_2 O_4|$
- $L_2$：input link（驅動桿）= $|O_2 A|$
- $L_3$：coupler link（連接桿）= $|AB|$
- $L_4$：output link（從動桿）= $|O_4 B|$

#### 關鍵性質 ⭐

**性質 1：姿態保持不變**

對於平行四邊形機構，連接桿（coupler link）的姿態始終保持不變：

$$
\theta_{\text{coupler}} = \text{constant}
$$

這意味著：**層架始終保持水平**（或任何我們設定的初始角度）。

**證明**：

設 ground link 水平，連接桿與水平線的夾角為 $\phi$。

由於 $L_2 = L_4$ 且 $L_2 \parallel L_4$，可知：

$$
\angle O_2 A B = \angle O_4 B A = \theta
$$

因此：

$$
\phi = 0 \quad \text{(始終保持水平)}
$$

**性質 2：運動軌跡為平移**

連接桿上任意一點的運動軌跡都是**直線平移**（translation），而非旋轉。

這對於下拉式層架來說是理想的，因為：
- ✅ 層架上的物品不會滑動
- ✅ 使用者容易拿取物品
- ✅ 視覺上更美觀

### 1.2 平行四邊形機構的運動學

#### 基本運動方程

設驅動桿 $O_2 A$ 與垂直線（y軸）的夾角為 $\theta$（順時針為正），則：

**點 A 的位置**：

$$
\begin{cases}
x_A = x_{O_2} + L_2 \sin\theta \\
y_A = y_{O_2} - L_2 \cos\theta
\end{cases}
$$

**點 B 的位置**（由於是平行四邊形）：

$$
\begin{cases}
x_B = x_A + L_1 \\
y_B = y_A
\end{cases}
$$

或者從 $O_4$ 出發：

$$
\begin{cases}
x_B = x_{O_4} + L_2 \sin\theta \\
y_B = y_{O_4} - L_2 \cos\theta
\end{cases}
$$

#### 下降距離公式 ⭐

當驅動桿從角度 $\theta_1$ 轉到 $\theta_2$ 時，層架的垂直下降距離為：

$$
\boxed{\Delta h = L_2 (\cos\theta_1 - \cos\theta_2)}
$$

**推導**：

$$
\begin{align}
\Delta h &= y_A(\theta_1) - y_A(\theta_2) \\
&= [y_{O_2} - L_2\cos\theta_1] - [y_{O_2} - L_2\cos\theta_2] \\
&= L_2\cos\theta_2 - L_2\cos\theta_1 \\
&= L_2(\cos\theta_1 - \cos\theta_2)
\end{align}
$$

**注意**：$\Delta h$ 定義為正值（向下）。

#### 水平移動距離公式

$$
\boxed{\Delta x = L_2 (\sin\theta_2 - \sin\theta_1)}
$$

**推導**：

$$
\begin{align}
\Delta x &= x_A(\theta_2) - x_A(\theta_1) \\
&= [x_{O_2} + L_2\sin\theta_2] - [x_{O_2} + L_2\sin\theta_1] \\
&= L_2(\sin\theta_2 - \sin\theta_1)
\end{align}
$$

當 $\theta_2 > \theta_1$ 時，$\Delta x > 0$（向右移動）。

---

## 2. 問題定義與座標系建立

### 2.1 座標系統定義

建立直角座標系：

```
       y (向上為正)
       ↑
       |
       |    櫃體
       |  ┌────────┐
       |  │        │ 80 cm
       |  │        │
       |  │        │
       |  └────────┘
       |   40 cm
       └────────────→ x (向右為正)
     O (原點)
```

**原點選擇**：櫃體左下角

**座標定義**：
- x 軸：水平向右為正
- y 軸：垂直向上為正
- 櫃體範圍：$0 \leq x \leq 40$ cm，$0 \leq y \leq 80$ cm

### 2.2 設計需求的數學表達

#### 硬性約束（Hard Constraints）

**約束 1：初始狀態 - 層架完全收納**

層架在初始狀態必須完全位於櫃體內部：

$$
\begin{cases}
0 < x_{\text{shelf}}^{(1)} < 40 \text{ cm} \\
0 < y_{\text{shelf}}^{(1)} < 80 \text{ cm}
\end{cases}
$$

**約束 2：最終狀態 - 下降至少 30 cm**

層架從櫃底（距地面 170 cm）下降至少 30 cm：

$$
h_{\text{final}} = 170 - \Delta h \leq 140 \text{ cm}
$$

即：

$$
\boxed{\Delta h \geq 30 \text{ cm}}
$$

**約束 3：層架保持水平**

$$
\theta_{\text{shelf}} = 0° \quad \forall t
$$

**約束 4：無碰撞**

在整個運動過程中，機構的任何部分都不能與櫃體發生碰撞。

#### 軟性目標（Soft Objectives）

**目標：最大化儲存空間**

$$
\max \quad A_{\text{storage}} = L_{\text{shelf}} \times D_{\text{shelf}}
$$

其中：
- $L_{\text{shelf}}$：層架寬度
- $D_{\text{shelf}}$：層架深度

### 2.3 設計問題的重新表述

**給定**：
- 櫃體尺寸：$40 \text{ cm} \times 80 \text{ cm}$
- 下降距離要求：$\Delta h \geq 30 \text{ cm}$

**求解**：
- 連桿長度 $L_2$
- 初始角度 $\theta_1$
- 最終角度 $\theta_2$
- 固定樞軸位置 $O_2(x_{O_2}, y_{O_2})$ 和 $O_4(x_{O_4}, y_{O_4})$

**優化目標**：
- 最大化層架儲存空間

---

## 3. 平行四邊形機構的幾何分析

### 3.1 機構配置方案選擇

對於下拉式層架，有兩種典型的平行四邊形配置：

#### 方案 A：垂直配置（Vertical Configuration）

```
初始狀態：
   O₂ ────── A ────── 層架
   │         │
   │ L₂      │ L₂
   │         │
   O₄ ────── B

   連桿垂直向下
```

**特點**：
- 初始時連桿垂直（$\theta_1 = 0°$）
- 層架緊貼櫃體後牆
- 下拉時向外擺動

#### 方案 B：傾斜配置（Inclined Configuration）

```
初始狀態：
   O₂ ──╲   A ────── 層架
   │      ╲  │
   │ L₂    ╲ │ L₂
   │        ╲│
   O₄ ──────╲B

   連桿已有初始傾角 θ₁
```

**特點**：
- 初始時連桿有傾角（$\theta_1 > 0°$）
- 更容易滿足深度限制（40 cm）
- 層架已稍微伸出

**✅ 選擇方案 B**，原因：
1. 40 cm 的深度限制很緊
2. 如果 $L_2 > 40$ cm，方案 A 無法滿足約束
3. 方案 B 更靈活，可以調整 $\theta_1$

### 3.2 關鍵設計變數的選擇

對於平行四邊形機構，我們需要確定以下設計變數：

| 變數 | 符號 | 說明 | 單位 |
|------|------|------|------|
| 連桿長度 | $L_2$ | 驅動桿和從動桿的長度 | cm |
| 固定桿長度 | $L_1$ | $O_2$ 和 $O_4$ 之間的距離 | cm |
| 初始角度 | $\theta_1$ | 初始狀態連桿與垂直線的夾角 | 度 |
| 最終角度 | $\theta_2$ | 最終狀態連桿與垂直線的夾角 | 度 |
| 固定點位置 | $O_2, O_4$ | 固定樞軸在櫃體中的位置 | cm |

**設計自由度分析**：
- 平行四邊形有 **5 個幾何參數**：$L_1, L_2, \theta_1, \theta_2, (x_{O_2}, y_{O_2})$
- 加上 1 個約束：$\Delta h \geq 30$ cm
- 因此有 **4 個自由度**可以用來優化

### 3.3 初步設計策略

**策略**：由外而內設計

1. **先確定角度範圍** $\theta_1, \theta_2$
   - 基於經驗和空間限制選擇

2. **計算所需連桿長度** $L_2$
   - 由下降距離公式反推

3. **確定固定點位置** $O_2, O_4$
   - 基於空間約束和對稱性

4. **計算層架尺寸**
   - 最大化儲存空間

---

## 4. 設計變數的確定

### 4.1 角度範圍的選擇

#### 初始角度 $\theta_1$ 的考量

**物理意義**：層架收起時，連桿與垂直線的夾角。

**選擇範圍**：$0° \leq \theta_1 \leq 45°$

**考慮因素**：

1. **深度限制**：

   層架初始深度（從櫃體後牆算起）：

   $$
   d_{\text{initial}} = L_2 \sin\theta_1
   $$

   必須滿足：

   $$
   L_2 \sin\theta_1 \leq 40 \text{ cm}
   $$

2. **櫃內空間利用**：

   $\theta_1$ 越小，層架越靠近櫃體後牆，空間利用率越高。

3. **運動行程**：

   $\theta_1$ 越小，可用的角度變化範圍越大。

**初步選擇**：$\theta_1 = 20°$

**理由**：
- 不會太垂直（避免 $L_2$ 過長）
- 不會太傾斜（保留足夠的角度變化範圍）
- 經驗上是一個平衡值

#### 最終角度 $\theta_2$ 的考量

**物理意義**：層架完全下降時，連桿與垂直線的夾角。

**選擇範圍**：$60° \leq \theta_2 \leq 90°$

**考慮因素**：

1. **下降距離**：

   由公式：

   $$
   \Delta h = L_2 (\cos\theta_1 - \cos\theta_2)
   $$

   $\theta_2$ 越大，$\cos\theta_2$ 越小，$\Delta h$ 越大。

2. **水平伸出距離**：

   $$
   \Delta x = L_2 (\sin\theta_2 - \sin\theta_1)
   $$

   $\theta_2$ 越大，層架伸出越遠，使用者越容易拿取。

3. **機構穩定性**：

   $\theta_2 = 90°$ 時，連桿水平，為奇異位置（singular configuration），應避免。

**初步選擇**：$\theta_2 = 75°$

**理由**：
- 提供足夠的下降距離
- 避免奇異位置（90°）
- 層架伸出適中，便於使用

### 4.2 連桿長度的計算

#### 由下降距離反推 $L_2$

**給定**：
- $\theta_1 = 20°$
- $\theta_2 = 75°$
- $\Delta h \geq 30$ cm

**計算**：

由公式：

$$
\Delta h = L_2 (\cos\theta_1 - \cos\theta_2)
$$

代入數值：

$$
30 = L_2 (\cos 20° - \cos 75°)
$$

計算三角函數值：

$$
\begin{align}
\cos 20° &= 0.9397 \\
\cos 75° &= 0.2588
\end{align}
$$

因此：

$$
30 = L_2 (0.9397 - 0.2588)
$$

$$
30 = L_2 \times 0.6809
$$

$$
\boxed{L_2 = \frac{30}{0.6809} = 44.05 \text{ cm}}
$$

**四捨五入**：$L_2 = 44$ cm

#### 驗證深度約束

檢查初始狀態的深度：

$$
d_{\text{initial}} = L_2 \sin\theta_1 = 44 \times \sin 20° = 44 \times 0.3420 = 15.05 \text{ cm}
$$

✅ $15.05 < 40$ cm，滿足深度限制。

#### 計算水平移動距離

$$
\begin{align}
\Delta x &= L_2 (\sin\theta_2 - \sin\theta_1) \\
&= 44 \times (\sin 75° - \sin 20°) \\
&= 44 \times (0.9659 - 0.3420) \\
&= 44 \times 0.6239 \\
&= 27.45 \text{ cm}
\end{align}
$$

這意味著層架會向外（向右）移動約 **27.45 cm**。

### 4.3 固定桿長度 $L_1$ 的確定

**定義**：$L_1 = |O_2 O_4|$（兩個固定樞軸之間的距離）

**設計考量**：

1. **結構穩定性**：
   - $L_1$ 越大，機構越穩定
   - 但會佔用更多櫃內空間

2. **層架寬度**：
   - 對於平行四邊形，層架寬度 ≈ $L_1$
   - $L_1$ 越大，層架越寬，儲存空間越大

3. **櫃體尺寸限制**：
   - $L_1 \leq 80$ cm（櫃體高度）

**初步選擇**：$L_1 = 50$ cm

**理由**：
- 提供足夠的層架寬度
- 不會佔用過多櫃體高度
- 結構穩定性良好

### 4.4 固定樞軸位置的確定

#### $O_2$ 的位置（上固定點）

**考量因素**：

1. **初始狀態層架位置**：

   層架應位於櫃內上部，接近櫃頂。

2. **安全間隙**：

   與櫃頂和側壁保持至少 5 cm 間隙。

3. **對稱性**：

   通常放在櫃體深度的中心附近。

**選擇**：

$$
O_2 = (x_{O_2}, y_{O_2}) = (10, 70) \text{ cm}
$$

**說明**：
- $x_{O_2} = 10$ cm：距離櫃體後牆 10 cm
- $y_{O_2} = 70$ cm：距離櫃底 70 cm，距櫃頂 10 cm（安全間隙）

#### $O_4$ 的位置（下固定點）

**根據 $L_1 = 50$ cm**：

由於我們選擇 $L_1 = 50$ cm（垂直方向），而且平行四邊形的固定桿是垂直的（為了簡化），因此：

$$
O_4 = (x_{O_4}, y_{O_4}) = (x_{O_2}, y_{O_2} - L_1) = (10, 20) \text{ cm}
$$

**說明**：
- $x_{O_4} = 10$ cm：與 $O_2$ 在同一垂直線上
- $y_{O_4} = 20$ cm：距離櫃底 20 cm，距櫃頂 60 cm

**檢查**：

$$
L_1 = |O_2 O_4| = \sqrt{(10-10)^2 + (70-20)^2} = 50 \text{ cm} \quad ✅
$$

---

## 5. 詳細計算過程

### 5.1 初始狀態（Position 1）的計算

#### 給定參數

$$
\begin{align}
\theta_1 &= 20° \\
L_2 &= 44 \text{ cm} \\
O_2 &= (10, 70) \text{ cm} \\
O_4 &= (10, 20) \text{ cm}
\end{align}
$$

#### 計算點 A 的位置

$$
\begin{align}
x_A^{(1)} &= x_{O_2} + L_2 \sin\theta_1 \\
&= 10 + 44 \times \sin 20° \\
&= 10 + 44 \times 0.3420 \\
&= 10 + 15.05 \\
&= 25.05 \text{ cm}
\end{align}
$$

$$
\begin{align}
y_A^{(1)} &= y_{O_2} - L_2 \cos\theta_1 \\
&= 70 - 44 \times \cos 20° \\
&= 70 - 44 \times 0.9397 \\
&= 70 - 41.35 \\
&= 28.65 \text{ cm}
\end{align}
$$

因此：

$$
\boxed{A^{(1)} = (25.05, 28.65) \text{ cm}}
$$

#### 計算點 B 的位置

由於是平行四邊形，$L_1$ 是垂直的：

$$
\begin{align}
x_B^{(1)} &= x_{O_4} + L_2 \sin\theta_1 \\
&= 10 + 15.05 \\
&= 25.05 \text{ cm}
\end{align}
$$

$$
\begin{align}
y_B^{(1)} &= y_{O_4} - L_2 \cos\theta_1 \\
&= 20 - 41.35 \\
&= -21.35 \text{ cm}
\end{align}
$$

⚠️ **問題**：$y_B^{(1)} < 0$，這意味著點 B 在櫃底下方！

**錯誤分析**：

我選擇的 $O_4$ 位置太低了。讓我重新調整。

#### 🔧 修正：調整固定點位置

**問題根源**：$O_4$ 的 y 座標太小。

**重新設計**：

讓我們重新思考固定點的位置。實際上，$L_1$ 不一定要垂直，也可以是水平的或傾斜的。

**新策略**：讓 $L_1$ 水平

$$
\begin{align}
O_2 &= (5, 65) \text{ cm} \\
O_4 &= (5 + L_1, 65) = (55, 65) \text{ cm} \quad \text{(假設 } L_1 = 50 \text{ cm)}
\end{align}
$$

但這樣 $O_4$ 的 x 座標 = 55 cm > 40 cm（超出櫃體範圍）！

**再次修正**：

問題在於 $L_1 = 50$ cm 太長了，無法在 40 cm 寬的櫃子裡水平放置。

**解決方案**：$L_1$ 必須傾斜或垂直，並且數值不能太大。

讓我採用更實際的配置：

$$
\begin{align}
L_1 &= 30 \text{ cm} \quad \text{(減小層架寬度)} \\
O_2 &= (8, 65) \text{ cm} \\
O_4 &= (8, 35) \text{ cm} \quad \text{(垂直配置)}
\end{align}
$$

檢查：

$$
L_1 = |O_2 O_4| = \sqrt{0^2 + 30^2} = 30 \text{ cm} \quad ✅
$$

### 5.2 重新計算初始狀態

#### 更新的參數

$$
\begin{align}
\theta_1 &= 20° \\
L_2 &= 44 \text{ cm} \\
L_1 &= 30 \text{ cm} \\
O_2 &= (8, 65) \text{ cm} \\
O_4 &= (8, 35) \text{ cm}
\end{align}
$$

#### 點 A 的位置

$$
\begin{align}
x_A^{(1)} &= 8 + 44 \times \sin 20° = 8 + 15.05 = 23.05 \text{ cm} \\
y_A^{(1)} &= 65 - 44 \times \cos 20° = 65 - 41.35 = 23.65 \text{ cm}
\end{align}
$$

$$
\boxed{A^{(1)} = (23.05, 23.65) \text{ cm}}
$$

#### 點 B 的位置

$$
\begin{align}
x_B^{(1)} &= 8 + 44 \times \sin 20° = 23.05 \text{ cm} \\
y_B^{(1)} &= 35 - 44 \times \cos 20° = 35 - 41.35 = -6.35 \text{ cm}
\end{align}
$$

⚠️ **仍然有問題**：$y_B^{(1)} < 0$

**根本問題**：$L_2 \cos\theta_1 = 41.35$ cm > $y_{O_4} = 35$ cm

這意味著即使 $\theta_1 = 20°$，連桿向下的分量仍然太大。

### 5.3 🔧 重新設計策略

**問題診斷**：

當 $\theta_1 = 20°$ 時：

$$
L_2 \cos 20° = 44 \times 0.9397 = 41.35 \text{ cm}
$$

這個垂直分量必須小於 $O_2$ 或 $O_4$ 到櫃底的距離。

**解決方案 1：增大初始角度 $\theta_1$**

如果 $\theta_1$ 更大，$\cos\theta_1$ 更小，垂直分量減少。

讓我們嘗試 $\theta_1 = 35°$：

$$
L_2 \cos 35° = 44 \times 0.8192 = 36.04 \text{ cm}
$$

仍然太大。

**解決方案 2：減小連桿長度 $L_2$**

但這會減少下降距離。讓我們重新計算。

如果 $\theta_1 = 30°$，$\theta_2 = 80°$：

$$
\Delta h = L_2 (\cos 30° - \cos 80°) = L_2 (0.8660 - 0.1736) = L_2 \times 0.6924
$$

要達到 $\Delta h = 30$ cm：

$$
L_2 = \frac{30}{0.6924} = 43.33 \text{ cm}
$$

垂直分量：

$$
L_2 \cos 30° = 43.33 \times 0.8660 = 37.52 \text{ cm}
$$

**解決方案 3：固定點放在更高的位置**

如果 $O_4 = (8, 45)$ cm，則：

$$
y_B^{(1)} = 45 - 37.52 = 7.48 \text{ cm} > 0 \quad ✅
$$

同時，$O_2$ 也需要相應提高：

$$
O_2 = (8, 45 + 30) = (8, 75) \text{ cm}
$$

檢查是否超出櫃體：$75 < 80$ cm ✅

### 5.4 最終設計參數（第一次迭代）

#### 確定的設計參數

$$
\begin{cases}
\theta_1 = 30° \\
\theta_2 = 80° \\
L_2 = 43.33 \approx 43.5 \text{ cm} \\
L_1 = 30 \text{ cm} \\
O_2 = (8, 75) \text{ cm} \\
O_4 = (8, 45) \text{ cm}
\end{cases}
$$

#### 初始狀態計算（Position 1）

**點 A**：

$$
\begin{align}
x_A^{(1)} &= 8 + 43.5 \times \sin 30° = 8 + 43.5 \times 0.5 = 8 + 21.75 = 29.75 \text{ cm} \\
y_A^{(1)} &= 75 - 43.5 \times \cos 30° = 75 - 43.5 \times 0.8660 = 75 - 37.67 = 37.33 \text{ cm}
\end{align}
$$

$$
\boxed{A^{(1)} = (29.75, 37.33) \text{ cm}}
$$

**點 B**：

$$
\begin{align}
x_B^{(1)} &= 8 + 43.5 \times \sin 30° = 29.75 \text{ cm} \\
y_B^{(1)} &= 45 - 43.5 \times \cos 30° = 45 - 37.67 = 7.33 \text{ cm}
\end{align}
$$

$$
\boxed{B^{(1)} = (29.75, 7.33) \text{ cm}}
$$

**層架中心點 C**（AB 的中點）：

$$
C^{(1)} = \left(\frac{x_A + x_B}{2}, \frac{y_A + y_B}{2}\right) = \left(29.75, \frac{37.33 + 7.33}{2}\right) = (29.75, 22.33) \text{ cm}
$$

**檢查約束**：

1. ✅ $0 < x_A, x_B < 40$ cm（在櫃體寬度內）
2. ✅ $0 < y_A, y_B < 80$ cm（在櫃體高度內）
3. ✅ 層架保持水平（平行四邊形性質）

#### 最終狀態計算（Position 2）

**點 A**：

$$
\begin{align}
x_A^{(2)} &= 8 + 43.5 \times \sin 80° = 8 + 43.5 \times 0.9848 = 8 + 42.84 = 50.84 \text{ cm} \\
y_A^{(2)} &= 75 - 43.5 \times \cos 80° = 75 - 43.5 \times 0.1736 = 75 - 7.55 = 67.45 \text{ cm}
\end{align}
$$

$$
\boxed{A^{(2)} = (50.84, 67.45) \text{ cm}}
$$

**點 B**：

$$
\begin{align}
x_B^{(2)} &= 8 + 43.5 \times \sin 80° = 50.84 \text{ cm} \\
y_B^{(2)} &= 45 - 43.5 \times \cos 80° = 45 - 7.55 = 37.45 \text{ cm}
\end{align}
$$

$$
\boxed{B^{(2)} = (50.84, 37.45) \text{ cm}}
$$

**層架中心點 C**：

$$
C^{(2)} = \left(50.84, \frac{67.45 + 37.45}{2}\right) = (50.84, 52.45) \text{ cm}
$$

⚠️ **問題**：$x_A^{(2)} = 50.84$ cm > 40 cm（超出櫃體！）

**這是預期的**，因為層架需要「拉出」櫃體才能下降。

#### 計算實際下降距離

$$
\begin{align}
\Delta h &= y_A^{(1)} - y_A^{(2)} \\
&= 37.33 - 67.45 \\
&= -30.12 \text{ cm}
\end{align}
$$

等等，這個負號表示層架實際上是**上升**了，而不是下降！

**錯誤分析**：

我搞混了座標系。讓我重新定義：

- 當 $\theta$ 增加時（從 30° 到 80°），點 A 向右上方移動
- 但我們希望層架**下降**

**問題根源**：我的角度定義和運動方向有問題。

### 5.5 🔧🔧 重新定義問題

讓我重新思考整個問題的幾何配置。

#### 正確的幾何配置

對於下拉式層架：

1. **初始狀態**：層架在櫃體**內上方**
2. **最終狀態**：層架在櫃體**外下方**

這意味著：

- 初始時，固定樞軸 $O_2$ 和 $O_4$ 應該在櫃體**頂部附近**
- 最終時，層架應該在櫃體**底部附近或下方**

#### 重新定義角度約定

讓我們重新定義角度 $\theta$：

$$
\theta = \text{連桿與水平線的夾角（逆時針為正）}
$$

**初始狀態**：連桿向上傾斜，$\theta_1 \approx -20°$（向下為負）
**最終狀態**：連桿向下傾斜，$\theta_2 \approx -60°$

或者，我們可以使用另一種約定：

$$
\alpha = \text{連桿與垂直向下方向的夾角}
$$

**初始狀態**：$\alpha_1 = 20°$（稍微偏離垂直）
**最終狀態**：$\alpha_2 = 60°$（大幅偏離垂直）

讓我採用第二種約定，並重新推導公式。

### 5.6 重新推導運動方程（正確版本）

#### 座標系與角度定義

```
        y ↑
          |
          |  O₂ (固定點，靠近櫃頂)
          |   ╲
          |    ╲ L₂
          |     ╲  α (與向下垂直線的夾角)
          |      ╲
          |       A (連接到層架)
          |       |
          |       | (層架)
          |       |
          |       B
          |      ╱
          |     ╱ L₂
          |    ╱ α
          |   ╱
          |  O₄ (固定點)
          |
          └──────────→ x
```

#### 新的位置方程

設 $O_2 = (x_{O_2}, y_{O_2})$，連桿與向下垂直線的夾角為 $\alpha$（順時針為正）。

**點 A 的位置**：

$$
\begin{cases}
x_A = x_{O_2} + L_2 \sin\alpha \\
y_A = y_{O_2} - L_2 \cos\alpha
\end{cases}
$$

當 $\alpha$ 從小角度（如 20°）增加到大角度（如 60°）時：

- $\sin\alpha$ 增加 → $x_A$ 增加（向右）
- $\cos\alpha$ 減小 → $y_A$ 減小得更少 → **向下移動**

但這仍然不對。讓我仔細分析...

實際上，當 $\alpha$ 增加時：

- $\cos\alpha$ 減小（從 $\cos 20° = 0.94$ 到 $\cos 60° = 0.5$）
- $y_A = y_{O_2} - L_2 \cos\alpha$ → $y_A$ 變大（因為減去的數變小）
- 所以 $y_A$ 是**增加**的，即向上！

**這還是不對！**

#### 🎯 正確的理解

讓我畫一個清楚的圖：

```
初始狀態（α₁ = 20°）：
      O₂
       ╲  小角度
        ╲
         A ← 層架位置較低

最終狀態（α₂ = 60°）：
      O₂
       ╲___  大角度
           ╲
            A ← 層架位置較高（錯！）
```

啊，我明白了！**問題在於固定點 $O_2$ 應該在下方，而不是上方！**

對於下拉式層架：

- 固定點應該在櫃體**底部**附近
- 連桿向上延伸到層架
- 初始時連桿接近垂直（層架在上方）
- 最終時連桿傾斜（層架向下、向外移動）

#### 正確的配置

```
初始狀態：
         A ← 層架（高位）
         |
         | L₂ (接近垂直)
         |
        O₂ ← 固定點（低位）

最終狀態：
              A ← 層架（低位，向外）
            ╱
          ╱ L₂ (傾斜)
        ╱
       O₂ ← 固定點
```

### 5.7 正確的計算（最終版本）

#### 重新定義

**固定點位置**（在櫃體底部附近）：

$$
\begin{align}
O_2 &= (8, 15) \text{ cm} \quad \text{(距櫃底 15 cm)} \\
O_4 &= (8, 45) \text{ cm} \quad \text{(距櫃底 45 cm)}
\end{align}
$$

$$
L_1 = |O_2 O_4| = 30 \text{ cm}
$$

**角度定義**：$\alpha$ = 連桿與向上垂直線的夾角（順時針為正）

**初始狀態**：$\alpha_1 = 20°$（接近垂直）
**最終狀態**：$\alpha_2 = 70°$（大幅傾斜）

**位置方程**：

$$
\begin{cases}
x_A = x_{O_2} + L_2 \sin\alpha \\
y_A = y_{O_2} + L_2 \cos\alpha
\end{cases}
$$

注意現在是 **加號**（$+L_2 \cos\alpha$），因為連桿向上延伸。

#### 確定 $L_2$

$$
\Delta h = L_2 \cos\alpha_1 - L_2 \cos\alpha_2 = L_2 (\cos\alpha_1 - \cos\alpha_2)
$$

代入：

$$
30 = L_2 (\cos 20° - \cos 70°) = L_2 (0.9397 - 0.3420) = L_2 \times 0.5977
$$

$$
\boxed{L_2 = \frac{30}{0.5977} = 50.19 \approx 50 \text{ cm}}
$$

#### 初始狀態（Position 1）

$$
\begin{align}
x_A^{(1)} &= 8 + 50 \times \sin 20° = 8 + 50 \times 0.342 = 8 + 17.1 = 25.1 \text{ cm} \\
y_A^{(1)} &= 15 + 50 \times \cos 20° = 15 + 50 \times 0.9397 = 15 + 46.99 = 61.99 \text{ cm}
\end{align}
$$

$$
\boxed{A^{(1)} = (25.1, 62.0) \text{ cm}}
$$

$$
\begin{align}
x_B^{(1)} &= 8 + 50 \times \sin 20° = 25.1 \text{ cm} \\
y_B^{(1)} &= 45 + 50 \times \cos 20° = 45 + 46.99 = 91.99 \text{ cm}
\end{align}
$$

⚠️ **問題**：$y_B^{(1)} = 92$ cm > 80 cm（超出櫃體頂部！）

需要再次調整...

讓我降低 $O_4$ 的位置：

$$
O_4 = (8, 30) \text{ cm}
$$

則：

$$
y_B^{(1)} = 30 + 46.99 = 76.99 \text{ cm} < 80 \text{ cm} \quad ✅
$$

同時調整 $O_2$：

$$
O_2 = (8, 0) \text{ cm} \quad \text{(在櫃底)}
$$

則：

$$
L_1 = |O_2 O_4| = 30 \text{ cm} \quad ✅
$$

#### 最終初始狀態計算

**更新參數**：

$$
\begin{cases}
L_2 = 50 \text{ cm} \\
L_1 = 30 \text{ cm} \\
\alpha_1 = 20° \\
\alpha_2 = 70° \\
O_2 = (8, 0) \text{ cm} \\
O_4 = (8, 30) \text{ cm}
\end{cases}
$$

**Position 1（初始）**：

$$
\begin{align}
A^{(1)} &= (8 + 50 \sin 20°, 0 + 50 \cos 20°) = (25.1, 47.0) \text{ cm} \\
B^{(1)} &= (8 + 50 \sin 20°, 30 + 50 \cos 20°) = (25.1, 77.0) \text{ cm}
\end{align}
$$

**檢查**：

- ✅ $0 < x_A, x_B = 25.1 < 40$ cm
- ✅ $0 < y_A = 47.0 < 80$ cm
- ✅ $0 < y_B = 77.0 < 80$ cm
- ✅ 層架水平：$x_A = x_B$

**Position 2（最終）**：

$$
\begin{align}
A^{(2)} &= (8 + 50 \sin 70°, 0 + 50 \cos 70°) = (8 + 46.98, 0 + 17.10) = (55.0, 17.1) \text{ cm} \\
B^{(2)} &= (8 + 50 \sin 70°, 30 + 50 \cos 70°) = (55.0, 47.1) \text{ cm}
\end{align}
$$

**檢查**：

- ⚠️ $x_A, x_B = 55$ cm > 40 cm（伸出櫃外，符合預期）
- ✅ $0 < y_A = 17.1 < 80$ cm
- ✅ $0 < y_B = 47.1 < 80$ cm

**下降距離**：

$$
\Delta h = y_A^{(1)} - y_A^{(2)} = 47.0 - 17.1 = 29.9 \approx 30 \text{ cm} \quad ✅
$$

或者檢查 B 點：

$$
\Delta h = y_B^{(1)} - y_B^{(2)} = 77.0 - 47.1 = 29.9 \text{ cm} \quad ✅
$$

**水平移動**：

$$
\Delta x = x_A^{(2)} - x_A^{(1)} = 55.0 - 25.1 = 29.9 \text{ cm}
$$

---

## 6. 方案驗證與調整

### 6.1 空間約束檢查

#### 初始狀態空間檢查

**層架占用空間**：

- 寬度方向：$x \in [25.1, 25.1]$ cm（層架深度另計）
- 高度方向：$y \in [47.0, 77.0]$ cm（層架高度）

假設層架深度為 25 cm（向左延伸）：

- 層架後緣：$x_{\text{back}} = 25.1 - 25 = 0.1$ cm
- 層架前緣：$x_{\text{front}} = 25.1$ cm

✅ 完全在櫃體內（$0 < x < 40$ cm）

#### 最終狀態空間檢查

- 層架後緣：$x_{\text{back}} = 55.0 - 25 = 30.0$ cm
- 層架前緣：$x_{\text{front}} = 55.0$ cm

層架伸出櫃外 $55 - 40 = 15$ cm，這是合理的。

### 6.2 中間位置檢查（避免碰撞）

讓我們檢查 $\alpha = 45°$ 時的位置：

$$
\begin{align}
A^{(\text{mid})} &= (8 + 50 \sin 45°, 0 + 50 \cos 45°) \\
&= (8 + 35.36, 35.36) \\
&= (43.36, 35.36) \text{ cm}
\end{align}
$$

$$
\begin{align}
B^{(\text{mid})} &= (43.36, 65.36) \text{ cm}
\end{align}
$$

層架後緣：$x_{\text{back}} = 43.36 - 25 = 18.36$ cm

✅ 沒有與櫃體後牆（$x = 0$）碰撞。

### 6.3 儲存空間計算

#### 層架尺寸

**層架寬度**（垂直於紙面，即 $L_1$ 方向）：

$$
W_{\text{shelf}} = L_1 = 30 \text{ cm}
$$

**層架深度**（水平方向，從 A/B 點向左延伸）：

為了不與櫃體後牆碰撞，初始狀態時：

$$
D_{\text{shelf}} \leq x_A^{(1)} - 0 = 25.1 \text{ cm}
$$

取 $D_{\text{shelf}} = 24$ cm（留 1 cm 安全間隙）

#### 儲存面積

$$
\boxed{A_{\text{storage}} = W_{\text{shelf}} \times D_{\text{shelf}} = 30 \times 24 = 720 \text{ cm}^2}
$$

---

## 7. 最終設計參數

### 7.1 設計方案 1 總結

#### 機構參數

| 參數 | 符號 | 數值 | 單位 |
|------|------|------|------|
| 連桿長度 | $L_2 = L_4$ | 50 | cm |
| 固定桿長度 | $L_1$ | 30 | cm |
| 連接桿長度 | $L_3$ | 30 | cm |
| 初始角度 | $\alpha_1$ | 20 | ° |
| 最終角度 | $\alpha_2$ | 70 | ° |

#### 固定樞軸位置

| 樞軸 | 座標 $(x, y)$ | 說明 |
|------|---------------|------|
| $O_2$ | $(8, 0)$ cm | 下固定點，在櫃底 |
| $O_4$ | $(8, 30)$ cm | 上固定點，距櫃底 30 cm |

#### 關鍵位置

**初始狀態（Position 1）**：

| 點 | 座標 $(x, y)$ (cm) |
|----|--------------------|
| A | $(25.1, 47.0)$ |
| B | $(25.1, 77.0)$ |
| 層架中心 | $(25.1, 62.0)$ |

**最終狀態（Position 2）**：

| 點 | 座標 $(x, y)$ (cm) |
|----|--------------------|
| A | $(55.0, 17.1)$ |
| B | $(55.0, 47.1)$ |
| 層架中心 | $(55.0, 32.1)$ |

#### 性能指標

| 指標 | 數值 | 目標 | 狀態 |
|------|------|------|------|
| 下降距離 | 29.9 cm | ≥ 30 cm | ⚠️ 略少 |
| 水平移動 | 29.9 cm | - | ✅ |
| 儲存面積 | 720 cm² | 最大化 | ✅ |
| 初始狀態 | 櫃內 | 櫃內 | ✅ |

### 7.2 微調以滿足 30 cm 要求

下降距離 29.9 cm 略少於 30 cm。讓我們微調 $\alpha_2$：

#### 重新計算 $\alpha_2$

$$
\Delta h = L_2 (\cos\alpha_1 - \cos\alpha_2) \geq 30
$$

$$
30 = 50 (\cos 20° - \cos\alpha_2)
$$

$$
\cos\alpha_2 = \cos 20° - \frac{30}{50} = 0.9397 - 0.6 = 0.3397
$$

$$
\alpha_2 = \arccos(0.3397) = 70.14° \approx 70.2°
$$

#### 更新最終狀態

$$
\begin{align}
A^{(2)} &= (8 + 50 \sin 70.2°, 0 + 50 \cos 70.2°) \\
&= (8 + 47.06, 0 + 16.99) \\
&= (55.1, 17.0) \text{ cm}
\end{align}
$$

$$
\Delta h = 47.0 - 17.0 = 30.0 \text{ cm} \quad ✅
$$

### 7.3 最終設計參數（修正版）

$$
\boxed{
\begin{align}
L_2 &= 50 \text{ cm} \\
L_1 &= 30 \text{ cm} \\
\alpha_1 &= 20.0° \\
\alpha_2 &= 70.2° \\
O_2 &= (8, 0) \text{ cm} \\
O_4 &= (8, 30) \text{ cm} \\
\text{儲存面積} &= 720 \text{ cm}^2
\end{align}
}
$$

---

## 8. 設計圖示

### 8.1 初始狀態示意圖

```
     y (cm)
     80 ├─────────────────┐
        │                 │ 櫃體
        │     B (25, 77)  │
        │     │           │
     60 │     │ 層架      │
        │     │           │
        │     A (25, 47)  │
     40 │                 │
        │                 │
        │ O₄ (8, 30)      │
     20 │                 │
        │                 │
      0 ├─────────────────┘
        O₂ (8, 0)
        0        20       40  x (cm)
```

### 8.2 最終狀態示意圖

```
     y (cm)
     80 ├─────────────────┐
        │                 │ 櫃體
     60 │                 │
        │                 │
        │     B (55, 47) ─┼─→ 伸出
     40 │    ╱            │
        │   ╱ O₄ (8, 30)  │
     20 │  ╱              │
        │ ╱ A (55, 17) ───┼─→ 伸出
      0 ├─────────────────┘
        O₂ (8, 0)
        0        20       40   55  x (cm)
```

### 8.3 運動軌跡圖

點 A 的運動軌跡（從初始到最終）：

$$
\begin{align}
x_A(\alpha) &= 8 + 50 \sin\alpha \\
y_A(\alpha) &= 0 + 50 \cos\alpha
\end{align}
$$

其中 $\alpha \in [20°, 70.2°]$。

這是一個圓弧，圓心在 $O_2 = (8, 0)$，半徑為 50 cm。

---

## 9. 後續步驟

### 9.1 Working Model 2D 驗證

將在下一份文檔（步驟 2）中詳細說明：

- [ ] 建立機構模型
- [ ] 設置連桿和樞軸
- [ ] 運行模擬
- [ ] 檢查碰撞
- [ ] 截取關鍵位置截圖

### 9.2 優化改進

將在步驟 3 中探討：

- [ ] 調整 $L_1$ 以增大儲存面積
- [ ] 調整固定點位置
- [ ] 探索非平行四邊形配置

### 9.3 方案比較

將在步驟 4 中進行：

- [ ] 比較不同 $L_1$ 的方案
- [ ] 比較不同角度範圍的方案
- [ ] 選擇最佳方案

---

## 10. 計算檢查清單

### 10.1 設計參數確認

- [x] $L_2 = 50$ cm
- [x] $L_1 = 30$ cm
- [x] $\alpha_1 = 20°$
- [x] $\alpha_2 = 70.2°$
- [x] $O_2 = (8, 0)$ cm
- [x] $O_4 = (8, 30)$ cm

### 10.2 約束滿足確認

- [x] 下降距離 $\Delta h = 30$ cm ✅
- [x] 初始狀態在櫃內 ✅
- [x] 層架保持水平 ✅
- [x] 無碰撞（初步檢查）✅

### 10.3 需要驗證的項目

- [ ] Working Model 2D 模擬
- [ ] 完整運動路徑的碰撞檢查
- [ ] 傳動角分析（確保無死點）
- [ ] 結構強度計算

---

## 附錄：關鍵公式總結

### A.1 平行四邊形機構運動學

$$
\begin{cases}
x_A = x_{O_2} + L_2 \sin\alpha \\
y_A = y_{O_2} + L_2 \cos\alpha
\end{cases}
$$

### A.2 下降距離公式

$$
\Delta h = L_2 (\cos\alpha_1 - \cos\alpha_2)
$$

### A.3 水平移動公式

$$
\Delta x = L_2 (\sin\alpha_2 - \sin\alpha_1)
$$

### A.4 儲存面積公式

$$
A_{\text{storage}} = L_1 \times D_{\text{shelf}}
$$

---

**下一步**：請繼續閱讀「步驟 2：Working Model 2D 驗證詳細指南.md」
